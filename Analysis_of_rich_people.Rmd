---
title: "Billionaires"
author: "Fabian & Robin"
date: "15.01.2024"
output: html_document
---
```{r setup, echo=FALSE, include=FALSE}
# Disable linting for file
# nolint start

knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(out.width = "100%")
```

This is the R project of Fabian and Robin. We decided to analyse data from billionaires.  
For that, we found a dataset on kaggle.com: <https://www.kaggle.com/datasets/nelgiriyewithana/billionaires-statistics-dataset>  
This dataset contains data from the 4th of april 2023 and is used for 'exploring the global landscape of success'.  

In the following, we will create several graphs to compare the correlation between certain columns of data and wealth. As this dataset only contains billionaires, we won't focus on the difference between their wealth. Being part of this list already means being incredibly rich. Accordingly, it is not necessary to analyze how much wealth is considered rich.

# 1. Definition and formulation of the questions

## What interests you about the data set? (Our theses)

- The distribution of billionaire wealth is highly concentrated among a small number of individuals.
- There is a strong correlation between the industries in which billionaires make their fortunes and the overall GDP of their countries.
- The geographic distribution of billionaires across countries reflects the global economic landscape and the opportunities for wealth creation in different regions.
- The relationship between age and becoming a billionaire.
- Countries with lower tax rates have more billionaires.
- Countries with better educational attainment have more billionaires.

## What specific questions would you like to answer with the help of the data set?

- How many billionaires own more than 80% of the total wealth?
- Which industry is the most profitable?
- What is the relationship between the distribution of billionaire wealth and the economic strength of a country, measured by GDP, tax revenue and population?
- Is there a geographical pattern to the distribution of billionaires across countries?
  - If so, what factors contribute to this distribution?
- How many billionaires are self-made, and are younger billionaires more likely to be self-made?
- In which countries do most billionaires inherit their wealth and why?
- Which countries have the lowest tax rates and how many billionaires do they have?
- Is there a correlation between educational attainment and the number of billionaires in a country?

## What do you expect from the data set in view of your question?

- Most wealth is held by 10% of billionaires.
- The most profitable sector is technology.
- Modern economies have more self-made billionaires.
- There is no geographical pattern.
- Younger billionaires are more likely to be self-made.
- Location does not correlate with wealth.

# 2. Loading the data

Load the data into the R session and get an initial overview Which types are included?

- Is it ensured that all data has the correct type?
- Does the data have any "oddities" that you need to deal with, such as differently coded NA's, multiple tables, ... etc.
- Depending on the data set, you can also load the data into a database and then access it in R.

Describe what you need to do before you can prepare and edit the data in the next section!


## Load Libraries
```{r}
# We used these libraries:
library(ggplot2) # to plot graphs and images
library(dplyr)
library(ggcorrplot)
library(ggthemes)
library(tidyverse)
library(gridExtra)
library(plotly)
```

## Read the CSV file into a dataframe called df_billionaires

```{r}
df_billionaires <- read.csv("BillionairesStatisticsDataset.csv")
# display data
head(df_billionaires)
```

## First inspection of the data

Each row displays one person that is a billionaire. The columns contain the following\
details about each person:

-   rank
    -   The ranking of the billionaire in terms of wealth (from 1 to 2640).\
-   finalWorth
    -   The final net worth of the billionaire in U.S. dollars.\
-   category
    -   The category or industry in which the billionaire's business operates.\
-   personName
    -   The full name of the billionaire.\
-   age
    -   The age of the billionaire in years.\
-   country
    -   The country in which the billionaire resides.\
-   city
    -   The city in which the billionaire resides\
-   source
    -   The source of the billionaire's wealth (eg. company name).\
-   industries
    -   The industries associated with the billionaire's business interests.\
-   countryOfCitizenship
    -   The country of citizenship of the billionaire.\
-   organization
    -   The name of the organization or company associated with the billionaire.\
-   selfMade
    -   Indicates whether the billionaire is self-made (True/False).\
-   status
    -   D=Entrepreneur and U = Inherited\
-   gender
    -   The gender of the billionaire.\
-   birthDate
    -   The birthdate of the billionaire.\
-   lastName
    -   The last name of the billionaire.\
-   firstName
    -   The first name of the billionaire.\
-   title
    -   The status or position of the billionaire (e.g., CEO, Founder).\
-   date
    -   The date of data collection.\
-   state
    -   The state in which the billionaire resides.\
-   redidenceStateRegion
    -   The region or state of residence of the billionaire.\
-   birthYear
    -   The birth year of the billionaire.\
-   birthMonth
    -   The birth month of the billionaire.\
-   birthDay
    -   The birth day of the billionaire.\
-   cpi_country
    -   Consumer Price Index (CPI) for the billionaire's country.\
-   cpi_change_country
    -   CPI change for the billionaire's country.\
-   gdp_country
    -   Gross Domestic Product (GDP) for the billionaire's country.\
-   gross_tertiary_education_enrollment
    -   Enrollment in tertiary education in the billionaire's country.\
-   gross_primary_education_enrollment_country
    -   Enrollment in primary education in the billionaire's country.\
-   life_expectancy_country
    -   Life expectancy in the billionaire's country.\
-   tax_revenue_country_country
    -   Tax revenue in the billionaire's country.\
-   total_tax_rate_country
    -   Total tax rate in the billionaire's country.\
-   population_country
    -   Population of the billionaire's country.\
-   latitude_country
    -   Latitude coordinate of the billionaire's country.\
-   longitude_country
    -   Longitude coordinate of the billionaire's country.

## We first started by creating a list of the top 10 richest billionaires:
```{r}
# Create a data frame with the top 10 billionaires
df_temp <- df_billionaires[1:10, ]

# Create a bar plot with text labels
ggplot(df_temp, aes(x = reorder(personName, -finalWorth), y = finalWorth, fill = personName)) + # nolint: line_length_linter, line_length_linter.
    geom_bar(stat = "identity") +
    geom_text(aes(label = paste0("$", finalWorth, "B")), vjust = -0.5, color = "black", size = 3) + # Add text labels # nolint: line_length_linter.
    labs(
        title = "Top 10 Billionaires and their Net Worth",
        x = "Billionaires",
        y = "Net Worth (in billions USD)",
        fill = "Billionaire"
    ) +
    theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

The plot displays ten bars in a barchart. Each bar represents the wealth of one billionaire. The plot only displays the top 10 richest billionaires. The height of the bar represents the wealth of the billionaire in US-dollars.

## correlation matrix between numeric values

The code calculates and visualizes the correlation matrix of numeric variables in the dataset, indicating the strength and direction of linear relationships between measures such as wealth, age, Consumer Price Index, Gross Domestic Product, life expectancy, and other relevant numeric columns.

```{r}
df_temp <- df_billionaires
# Convert 'birthDate' to Date type
df_temp$birthDate <- as.Date(df_temp$birthDate, format = "%m/%d/%Y")

# Filter only numeric columns for correlation analysis
numeric_cols <- sapply(df_temp, is.numeric)
df_temp_numeric <- df_temp[, numeric_cols]

# Remove column rank
df_temp_numeric <- df_temp_numeric[, !colnames(df_temp_numeric) %in% c("rank")]

# Remove NA and NaN values
df_temp_numeric <- na.omit(df_temp_numeric)

# Plot correlation matrix
ggcorrplot(cor(df_temp_numeric), type = "lower", lab = TRUE)
```
As you can see... 
TODO: CHANGE SIZE OF PLOT TO MAKE IT READABLE?

# 3. Editing/transforming the data

In this section, you should perform all the necessary transformations/cleansing/... etc. of the data (Data Muning, Data Cleansing), e.g:  

- Recoding of data, e.g. numerical to categorical
- Subsetting the data
- Joining of data tables - if necessary. Which join is necessary? Why?
- ...

Get an overview of the transformed data. You can use tools such as
`glimpse()`, `skim()` and `head()` to illustrate your explanations.  
  
Is the resulting data what you expected? Why or why not?

## The distribution of billionaire wealth is highly concentrated among a small number of individuals.

## There is a strong correlation between the industries in which billionaires make their fortunes and the overall GDP of their countries.

```{r}
# Clean 'finalWorth' column and convert to numeric
df_billionaires$finalWorth <- as.numeric(gsub("[^0-9.]", "", df_billionaires$finalWorth))
```

## The geographic distribution of billionaires across countries reflects the global economic landscape and the opportunities for wealth creation in different regions.

## The relationship between age and becoming a billionaire.

## Countries with lower tax rates have more billionaires.

## Countries with better educational attainment have more billionaires.

## Remaining questions

# 4. Appropriate visualization and aggregation of the data

Summarize the data in a suitable form to answer your formulated question.
summarized. You should also use suitable visualizations of the transformed and/or aggregated data
to support or illustrate your statements accordingly.  

You can also use suitable statistical methods or modeling here if they help you with your research question.

## The distribution of billionaire wealth is highly concentrated among a small number of individuals.

We think that only a small amount of individuals own a huge part of the entire wealth of all billionaires. The same is already proven for the entire world population: "half of the world's net wealth belongs to the top 1%, top 10% of adults hold 85%, while the bottom 90% hold the remaining 15% of the world's total wealth, top 30% of adults hold 97% of the total wealth". 

For that, we'll look at the wealth distribution between the billionaires in this dataset:

```{r}
ggplot(df_billionaires, aes(x = finalWorth)) +
    geom_histogram(binwidth = 10000, fill = "blue", color = "black") +
    labs(title = "Billionaire Wealth Distribution", x = "Final Worth", y = "Amount of billionaires") +
    theme_minimal()
```

The plot shows, that the lower the finalWorth is, the higher the frequency gets. This means that most billionaires are barely above the threshold of 1 billion usd. Only a few billionaires have a higher finalWorth than 25000 million usd.

### How many billionaires own more than 80% of the total wealth?

Due to the global wealth being around $454.4 trillion in 2022. We cannot really calculate the amount of people that own 80% of the global wealth. But we can calculate the amount of billionaires that own more than 80% of the totalWealth of all billionaires:

```{r}
# Calculate the total wealth
total_wealth <- sum(df_billionaires$finalWorth)

cat("All billionaires wealth combined sums up to", total_wealth, "million usd.\n")

# Calculate percentage of billionaires wealth compared to global wealth:
result <- (total_wealth * 1e6) / (454.4 * 1e12)
cat("The entire wealth of all billionaires is just", result * 100, "% of the global wealth.\n")

# Sort billionaires by wealth in descending order
sorted_billionaires <- df_billionaires[order(df_billionaires$finalWorth, decreasing = TRUE), ]

# Calculate the cumulative sum of wealth
sorted_billionaires$cumulative_wealth <- cumsum(sorted_billionaires$finalWorth)

# Find the number of billionaires required to own more than 80% of total wealth
num_billionaires_80_percent <- sum(sorted_billionaires$cumulative_wealth <= 0.8 * total_wealth)

# Print the result
cat("Number of billionaires owning more than 80% of total wealth of billionaires:", num_billionaires_80_percent, "\n")
```

The richest 1157 billionaires own 80% of the combined wealth of all billionaires. Assuming this dataset is complete, there are 2640 billionaires.

Let's look at how many billionaires own half the entire wealth of all billionaires:

```{r}
# Find the number of billionaires required to own more than 80% of total wealth
num_billionaires_80_percent <- sum(sorted_billionaires$cumulative_wealth <= 0.5 * total_wealth)

# Print the result
cat("Number of billionaires owning more than 50% of total wealth of billionaires:", num_billionaires_80_percent, "\n")
```

Only 302 of all 2640 billionaires own more than 50% of the total wealth. This proves that the tendency stays the same for the richest interval of wealth (billionaires) compared to the entire scope. 

## There is a strong correlation between the industries in which billionaires make their fortunes and the overall GDP of their countries.

To check if there is a correlation, lets compare the industries with the gdp:

```{r}
ggplot(df_billionaires, aes(x = finalWorth, y = industries)) +
    geom_point() +
    labs(
        title = "Correlation Between GDP (finalWorth) and Industry",
        x = "GDP (finalWorth)",
        y = "Industry"
    )
```

On this plot you cannot really see a pattern. Lets zoom in on billionaires below $25 billion:

```{r}
# Filter the dataset for billionaires with wealth below $25,000
filtered_data <- subset(df_billionaires, finalWorth < 25000)

# Create a scatter plot
ggplot(filtered_data, aes(x = finalWorth, y = industries)) +
    geom_point() +
    labs(
        title = "Correlation Between GDP (finalWorth) and Industry for Billionaires Below $25,000",
        x = "GDP (finalWorth)",
        y = "Industry"
    )
```

There is no obvious pattern or correlation.

### Which industry is the most profitable?

To calculate the most profitable industry, we can calculate the average wealth for each industry and compare them:

```{r}
# Calculate average wealth by industry
average_wealth_by_industry <- tapply(df_billionaires$finalWorth, df_billionaires$industries, mean, na.rm = TRUE)

# Identify the industry with the highest average wealth
most_profitable_industry <- names(average_wealth_by_industry[which.max(average_wealth_by_industry)])

# Print the result
cat("The most profitable industry is:", most_profitable_industry, "\n")
```

```{r}
# Create a data frame for plotting
plot_data <- data.frame(
    industry = names(average_wealth_by_industry),
    average_wealth = average_wealth_by_industry
)

# Sort the data frame by average wealth
plot_data <- plot_data[order(plot_data$average_wealth, decreasing = TRUE), ]

# Bar plot
barplot(plot_data$average_wealth,
    names.arg = plot_data$industry,
    main = "Average Wealth by Industry",
    xlab = "Industry", ylab = "Average Wealth",
    col = "skyblue", cex.names = 0.8, las = 2
)
```

This bar chart shows that the industries don't really differ in being the most profitable. Also the results are inaccurate, due to vague classifications of their industries.

The following bar chart shows the wealth distribution over all industries given in the data set. It also differentiates between self-made wealth and inherited wealth. I also removed the top billionaires above $25 billion.

```{r}
# Bar chart: Wealth by Industry
ggplot(filtered_data, aes(x = reorder(category, -finalWorth), y = finalWorth, fill = selfMade)) +
    geom_bar(stat = "identity", position = "dodge") +
    theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
    labs(
        title = "Wealth by Industry",
        x = "Industry",
        y = "Final Net Worth",
        fill = "Self-Made"
    )
```

Billionaires working in Energy, Telecom, Gambling & Casinos, Sports, Service and Construction & Engineering are mostly self-made. Industries like Finance & Investment and Media & Entertainment are dominated by billionaires that inherited their wealth. Overall the Technology and Manufacturing industry has a lot of billionaires below $25 billion. We should also mention that this data is probably not 100% accurate due to the rough classification of the industry of each billionaire.

### What is the relationship between the distribution of billionaire wealth and the economic strength of a country, measured by GDP, tax revenue and population?

SAMPLE

```{r}

```

SAMPLE

## The geographic distribution of billionaires across countries reflects the global economic landscape and the opportunities for wealth creation in different regions.
### Is there a geographical pattern to the distribution of billionaires across countries?<br>If so, what factors contribute to this distribution?
First of all we take a look at the wealth of the billionaires per country.\
```{r}
# Get finalworth per country
df_temp <- na.omit(df_billionaires[c("country", "finalWorth")]) %>%
    # Group by country
    group_by(country) %>%
    # Count billionaires per country
    summarise(
        count = n(),
        total_finalWorth = (sum(finalWorth) / 1000)
        # Hier können Sie weitere Aggregationsfunktionen hinzufügen, falls benötigt
    ) %>%
    # Keep only countries with more than 4 billionaires
    filter(count >= 5)

# Plot as world map with plotly
plot_ly(
    type = "choropleth",
    locations = df_temp$country,
    locationmode = "country names",
    z = df_temp$total_finalWorth,
    text = df_temp$country,
    colorscale = "Turbo",
    colorbar = list(title = "Net Worth"),
) %>%
    layout(
        title = "Total Net Worth of Billionaires per Country in Billion USD",
        geo = list(
            showframe = FALSE
        )
    )
```
The most wealth lies in usa and china. Chinese billionaires are mostly self-made. This may be, because China's economy just recently transformed from a largely agrarian and impoverished nation to the world's second-largest economy, driven by their market reforms and globalization. In the U.S. roughly 1/3 of the billionaires inherited their wealth.\
\
Let us now take a look at the number of billionaires per country.\
```{r}
# Filter for billionaires with country
df_temp <- na.omit(df_billionaires["country"]) %>%
    # Group by country
    group_by(country) %>%
    # Count billionaires per country
    summarise(count = n()) %>%
    # Sort by count
    arrange(desc(count))

# Plot as world map with plotly
plot_ly(
    type = "choropleth",
    locations = df_temp$country,
    locationmode = "country names",
    z = df_temp$count,
    text = df_temp$country,
    colorscale = "Turbo",
    colorbar = list(title = "Amount"),
) %>%
    layout(
        title = "Number of Billionaires per Country",
        geo = list(
            showframe = FALSE
        )
    )
```
The five countries with the most billionaires are:\
```{r}
for (i in 1:5) {
    cat(df_temp[i, ]$country, ":", df_temp[i, ]$count, "\n")
}
```
What we can see is, that this plot is almost the same as the previous one.\
The most billionaires are living in the USA,China and India.\
This is not surprising, because these are the countries with the highest economic power.\
\


Let us now take a look at the number of billionaires per capita.\
```{r}
# Calculate billionaires per capita
df_temp <- na.omit(df_billionaires[c("country", "population_country")]) %>%
    # Group by country
    group_by(country) %>%
    # Count billionaires per country
    summarise(
        count = n(),
        total_population = first(population_country)
        # Hier können Sie weitere Aggregationsfunktionen hinzufügen, falls benötigt
    ) %>%
    # Keep only countries with more than 4 billionaires
    filter(count >= 5) %>%
    # Calculate billionaires per capita
    mutate(billionaires_per_capita = (count / total_population) * 100) %>%
    # Sort by count
    arrange(desc(billionaires_per_capita))

# plot first 10 as bar chart
ggplot(df_temp[1:10, ], aes(x = reorder(country, -billionaires_per_capita), y = billionaires_per_capita)) +
    geom_bar(stat = "identity") +
    labs(
        title = "Billionaires per Capita",
        x = "Country",
        y = "Billionaires per Capita"
    ) +
    theme(axis.text.x = element_text(angle = 45, hjust = 1))

print(df_temp[1:10, ])
```
But if you look at the number of billionaires per capita, you can see that the USA is not the country with the most billionaires per capita.\
The country with the most billionaires per capita is Monaco with 17 billionaires, where only 39,000 people live.\
The second country is Switzerland with 78 billionaires, where 8.5 million people live.\
And the third Country is Singapore with 46 billionaires, where 5.7 million people live.\
\

As the next step we wanted to find out if there is a correlation between the number of billionaires and the GDP of a country.\

```{r}
# Filter for billionaires with country
# df_temp <- na.omit(df_billionaires[c("country", "gdp_country")]) %>%
#     # Group by country
#     group_by(country) %>%
#     # Count billionaires per country
#     summarise(
#         count = n(),
#         gdp = first(gdp_country)
#         # Hier können Sie weitere Aggregationsfunktionen hinzufügen, falls benötigt
#     ) %>%
#     # Keep only countries with more than 4 billionaires
#     filter(count >= 5) %>%
#     # Calculate billionaires per capita
#     mutate(billionaires_per_gdp = (count / gdp) * 100) %>%
#     # Sort by count
#     arrange(desc(billionaires_per_gdp))
```

### In which countries do most billionaires inherit their wealth and why?
First of all we wanted to check, if there is a mathematical correlation between the selfMade attribute and other attributes, which we can easily calculate.\
```{r}
# use df_billionaires and corellate selfMade with some columns
columns <- c("gender", "category", "birthYear", "birthMonth", "age", "finalWorth", "country", "city", "state", "selfMade")

df_temp <- na.omit(df_billionaires[columns])

# convert columns to factor
df_temp <- as.data.frame(lapply(df_temp, as.factor))

# conver all to numeric
df_temp <- as.data.frame(lapply(df_temp, as.numeric))

# corellate selfMade attribute with everything
self_made_corr <- cor(df_temp)

# Print out the correlations of selfMade
self_made_corr <- self_made_corr["selfMade", ]

# Drop selfMade
self_made_corr <- self_made_corr[-which(names(self_made_corr) == "selfMade")]

# print temp as bar chart (temp is named vector)
ggplot(data.frame(x = names(self_made_corr), y = self_made_corr), aes(x = reorder(x, -y), y = y)) +
    geom_bar(stat = "identity") +
    labs(
        title = "correlation of Self-Made with other Attributes",
        x = "Attribute",
        y = "correlation"
    ) +
    theme(axis.text.x = element_text(angle = 45, hjust = 1))
```


```{r}
# Filter for inherited billionaires
df_temp.inherited <- na.omit(df_billionaires[c("country", "selfMade")]) %>%
    filter(selfMade == FALSE) %>%
    group_by(country) %>%
    summarise(count = n()) %>%
    arrange(desc(count))


df_temp.overall <- na.omit(df_billionaires[c("country", "selfMade")]) %>%
    group_by(country) %>%
    summarise(count = n()) %>%
    arrange(desc(count))

# Print out country with most inherited billionaires
cat(
    "The country with the most inherited billionaires is", df_temp.inherited[1, ]$country, "with", df_temp.inherited[1, ]$count, "billionaires.\n",
    "The country with the most billionaires overall is", df_temp.overall[1, ]$country, "with", df_temp.overall[1, ]$count, "billionaires."
)
```
As We can see, the country with the most inherited billionaires is the same as the country with the most billionaires overall.\
This is not surprising, because the more billionaires a country has, the more billionaires can inherit their wealth.\

## The relationship between age and becoming a billionaire.
This plot gives on overview on the generated or inherited wealth by each billionaire indexed by their age. The x-axis demonstrates the age from 1 to 100+ and the y-axis demonstrates the wealth. Blue dots indicate a self-made wealth, while red dots indicate inherited wealth.

```{r}
# Scatter plot: Wealth vs. Age
ggplot(df_billionaires, aes(x = age, y = finalWorth, color = selfMade)) +
    geom_point() +
    labs(
        title = "Wealth vs. Age",
        x = "Age",
        y = "Final Net Worth",
        color = "Self-Made"
    )
```

Let's also look at the youngest self-made billionaire:

```{r}
df_temp <- df_billionaires
# Remove NA values
df_temp <- na.omit(df_temp)
# Filter for self-made billionaires and find the minimum age
youngest_age <- min(df_temp[df_temp$selfMade == TRUE, ]$age)
# Print the result
cat("The age of the youngest self-made billionaire is", youngest_age, "years.")
```

This indicates that young billionaires below the age of 28 most definitely inherited their wealth. The youngest self-made billionaire is 28 years old. As the age increases, there is no obvious pattern. The only thing worth mentioning is that the richest billionaires are mostly self-made. This probably results out of the fact of inflation and the growing gap between rich and poor.
Let's zoom in on billionaires with a wealth below $25 billion:

```{r}
# Filter out rows with missing values in finalWorth or age
filtered_data <- subset(df_billionaires, !is.na(finalWorth) & !is.na(age) & finalWorth < 25000)

# Scatter plot: Wealth vs. Age
ggplot(filtered_data, aes(x = age, y = finalWorth, color = selfMade)) +
    geom_point() +
    labs(
        title = "Wealth vs. Age",
        x = "Age",
        y = "Final Net Worth",
        color = "Self-Made"
    )
```

This also shows no obvious pattern. 

Let's also look at a bar chart showing the amount of billionaires for each age:

```{r}
# Create a bar plot: Count of billionaires by age, differentiated by selfMade
ggplot(filtered_data, aes(x = age, fill = factor(selfMade))) +
    geom_bar(position = "dodge", color = "black") +
    labs(
        title = "Number of Billionaires by Age",
        x = "Age",
        y = "Number of Billionaires",
        fill = "Self-Made"
    ) +
    theme_minimal()
```

Here you can see that self-made billionaires are generally younger than billionaires who inherited their wealth. You can also see a lot of self-made billionaires who are about 58 years old. This may indicate that being born about 60 years ago is a good time to get rich.

### How many billionaires are self-made, and are younger billionaires more likely to be self-made?

First let's look at how many billionaires are self-made:

```{r}
# Count the number of self-made billionaires
self_made_count <- sum(df_billionaires$selfMade == TRUE)

# Print the count
cat("Number of self-made billionaires: ", self_made_count, "/2640\n")
```

Out of the 2,640 billionaires worldwide, 1,812 are considered self-made, meaning they accumulated their wealth through entrepreneurship and business endeavors rather than inheriting it. This trend can be attributed to the increasing opportunities for innovation and entrepreneurship in the global economy, fostering a conducive environment for individuals to create and grow their own businesses. Factors such as technological advancements, globalization, and access to capital have empowered individuals to pursue entrepreneurial ventures, leading to a significant number of self-made billionaires. Additionally, the rise of industries like technology has provided platforms for innovative minds to disrupt traditional business models and amass substantial fortunes.
Are younger billionaires more likely to be self-made?

```{r}
# Create age groups (you can adjust the breaks and labels accordingly)
age_breaks <- c(0, 20, 30, 40, 50, 60, 70, 80, 90, Inf)
age_labels <- c("<20", "20-29", "30-39", "40-49", "50-59", "60-69", "70-79", "80-89", "90+")
df_billionaires$age_group <- cut(df_billionaires$age, breaks = age_breaks, labels = age_labels, right = FALSE)

# Create a summary table of the proportion of self-made billionaires in each age group
summary_table <- table(df_billionaires$age_group, df_billionaires$selfMade)
prop_table <- prop.table(summary_table, margin = 1)

# Create a bar plot
ggplot(df_billionaires, aes(x = age_group, fill = factor(selfMade))) +
    geom_bar(position = "fill") +
    labs(
        title = "Proportion of Self-Made Billionaires in Different Age Groups",
        x = "Age Group",
        y = "Proportion"
    ) +
    scale_fill_manual(values = c("FALSE" = "red", "TRUE" = "green"), name = "Self-Made")
```

No, young billionaires are not more likely to be self-made. Between the age of 30 and 90, most billionaires are self-made.

## Countries with lower tax rates have more billionaires.
### Which countries have the lowest tax rates and how many billionaires do they have?
First of all we wanted to find out which countries have the lowest tax rates.\
```{r}
# Which countries have the lowest tax rates and how many billionaires do they have?
# Sort by total_tax_rate_country
df_temp <- df_billionaires

# Remove NA values
df_temp <- na.omit(df_temp)

# count billionaires per country keep the tax rate
df_temp <- df_temp %>%
    group_by(country, total_tax_rate_country) %>%
    summarise(count = n())

# Keep only countries with more than 4 billionaires
df_temp <- df_temp[df_temp$count >= 5, ]

# Sort by total_tax_rate_country
df_temp <- df_temp[order(df_temp$total_tax_rate_country), ]

# Print out the country, tax rate and number of billionaires
cat("The country with the lowest tax rate is", df_temp[1, ]$country, "with a tax rate of", df_temp[1, ]$total_tax_rate_country, "and", df_temp[1, ]$count, "billionaires.")

# print out all countries with their tax rate and number of billionaires
print(df_temp, n = nrow(df_temp))
```

## Countries with better educational attainment have more billionaires.
### Is there a correlation between educational attainment and the number of billionaires in a country?
Let us first get an overview of the educational attainment of the billionaires.\
```{r}
# plot count of primary and tertiary side by side
df_temp_primary <- df_billionaires[c("gross_primary_education_enrollment_country")] %>%
    # Remove NA values
    na.omit() %>%
    # Group by country
    group_by(gross_primary_education_enrollment_country) %>%
    # Count billionaires per country
    summarise(
        count = n(),
        primary_education = first(gross_primary_education_enrollment_country),
    ) %>%
    arrange(desc(primary_education))

df_temp_tertiary <- df_billionaires[c("gross_tertiary_education_enrollment")] %>%
    # Remove NA values
    na.omit() %>%
    # Group by country
    group_by(gross_tertiary_education_enrollment) %>%
    # Count billionaires per country
    summarise(
        count = n(),
        tertiary_education = first(gross_tertiary_education_enrollment),
    ) %>%
    arrange(desc(tertiary_education))

primary_plot <- ggplot(df_temp_primary[1:10, ], aes(x = reorder(primary_education, -count), y = count)) +
    geom_bar(stat = "identity") +
    labs(
        title = "Count of billionaires per primary education",
        x = "Primary Education",
        y = "Count"
    ) +
    theme(axis.text.x = element_text(angle = 45, hjust = 1))

tertiary_plot <- ggplot(df_temp_tertiary[1:10, ], aes(x = reorder(tertiary_education, -count), y = count)) +
    geom_bar(stat = "identity") +
    labs(
        title = "Count of billionaires per tertiary education",
        x = "Tertiary Education",
        y = "Count"
    ) +
    theme(axis.text.x = element_text(angle = 45, hjust = 1))

grid.arrange(primary_plot, tertiary_plot, ncol = 2)
```

Now lets calculate if there is a correlation between the amount of billionaires and the primary/tertiary education.\
```{r}
# calculate correlation between count of billionaires and primary/tertiary education
correlation_primary <- cor(df_temp_primary)
correlation_tertiary <- cor(df_temp_tertiary)

# print correlation
cat("Primary education correlation:", correlation_primary[1, 2])
cat("Tertiary education correlation:", correlation_tertiary[1, 2])
```




To answer this question, we first had to find out which countries have the best educational attainment.\
```{r}
# Get the countries with the best educational attainment
df_temp <- df_billionaires[c("gross_primary_education_enrollment_country", "gross_tertiary_education_enrollment", "country")] %>%
    # Remove NA values
    na.omit() %>%
    # Group by country
    group_by(country) %>%
    # Count billionaires per country
    summarise(
        primary_education = first(gross_primary_education_enrollment_country),
        tertiary_education = first(gross_tertiary_education_enrollment)
        # Hier können Sie weitere Aggregationsfunktionen hinzufügen, falls benötigt
    ) %>%
    arrange(desc(primary_education))
df_temp_primary <- df_temp
df_temp_tertiary <- arrange(df_temp, desc(tertiary_education))

# compare the first 10 countries with the best primary education and the first 10 countries with the best tertiary education in a plot

primary_plot <- ggplot(df_temp_primary[1:10, ], aes(x = reorder(country, -primary_education), y = primary_education)) +
    geom_bar(stat = "identity") +
    labs(
        title = "Countries with the best primary education",
        x = "Country",
        y = "Primary Education"
    ) +
    theme(axis.text.x = element_text(angle = 45, hjust = 1))

tertiary_plot <- ggplot(df_temp_tertiary[1:10, ], aes(x = reorder(country, -tertiary_education), y = tertiary_education)) +
    geom_bar(stat = "identity") +
    labs(
        title = "Countries with the best tertiary education",
        x = "Country",
        y = "Tertiary Education"
    ) +
    theme(axis.text.x = element_text(angle = 45, hjust = 1))

grid.arrange(primary_plot, tertiary_plot, ncol = 2)
```

# 5. Summary and conclusion
Summarize your research question and your findings from your analysis here.  
Are your findings what you expected? Why or why not?